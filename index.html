<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Player de Canais</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #1a1a1a;
            color: #f0f0f0;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }
        .header {
            background-color: #2c3e50;
            padding: 15px;
            text-align: center;
            border-bottom: 5px solid #e74c3c;
            flex-shrink: 0;
        }
        .header h1 {
            margin: 0;
            color: #ecf0f1;
            font-size: 1.5rem;
        }
        .container {
            display: flex;
            flex: 1;
            padding: 10px;
            gap: 15px;
            overflow: hidden; /* Evita scroll duplo na página inteira */
        }
        .player-area {
            flex: 3;
            background-color: #000;
            border-radius: 8px;
            overflow: hidden;
            position: relative;
            border: 2px solid #333;
            display: flex;
            flex-direction: column;
        }
        .channel-list-area {
            flex: 1;
            max-width: 320px;
            background-color: #2c3e50;
            border-radius: 8px;
            display: flex;
            flex-direction: column;
            border: 1px solid #333;
        }
        .channel-list-area h2 {
            color: #e74c3c;
            margin: 10px 0;
            text-align: center;
            font-size: 1.2rem;
        }
        #channel-search {
            width: 90%;
            margin: 0 auto 10px auto;
            padding: 10px;
            background-color: #34495e;
            border: 1px solid #4e6377;
            color: white;
            border-radius: 5px;
        }
        #channel-list-scroll {
            flex-grow: 1;
            overflow-y: auto;
            padding: 0 10px 10px 10px;
        }
        /* Scrollbar customizada */
        #channel-list-scroll::-webkit-scrollbar { width: 6px; }
        #channel-list-scroll::-webkit-scrollbar-thumb { background: #e74c3c; border-radius: 3px; }
        #channel-list-scroll::-webkit-scrollbar-track { background: #2c3e50; }

        .category-title {
            color: #f1c40f;
            font-size: 0.9rem;
            margin: 15px 0 5px 0;
            border-bottom: 1px solid #4e6377;
            padding-bottom: 3px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .channel-button {
            width: 100%;
            padding: 12px;
            margin-bottom: 5px;
            background-color: #34495e;
            color: #ecf0f1;
            border: none;
            border-radius: 4px;
            text-align: left;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .channel-button:hover { background-color: #3e566e; transform: translateX(2px); }
        .channel-button.active { 
            background-color: #e74c3c; 
            color: white; 
            box-shadow: 0 0 8px rgba(231, 76, 60, 0.6); 
        }
        
        /* Área do Player e Proteção */
        .video-container {
            position: relative;
            flex: 1;
            width: 100%;
            height: 100%;
            background: #000;
        }

        iframe.player-iframe {
            width: 100%;
            height: 100%;
            border: none;
            display: block;
            position: absolute;
            top: 0;
            left: 0;
        }

        #current-channel-name {
            background-color: #111;
            color: #f1c40f;
            padding: 8px;
            text-align: center;
            font-size: 1rem;
            border-bottom: 1px solid #333;
        }

        /* --- NOVA BLOQUEIO AVANÇADO --- */
        /* Esta div cobre todo o player */
        #ad-shield {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 9999; /* Maior que tudo dentro do player-area */
            background: transparent;
            pointer-events: none; /* Deixa passar cliques por padrão */
        }

        /* Classe que ativa o clique no escudo (bloqueia anúncio) */
        #ad-shield.block-mode {
            pointer-events: auto; /* Intercepta todos os cliques */
            cursor: wait;
        }

        /* Pequeno botão para fechar o escudo manualmente se algo der errado */
        #close-shield {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(231, 76, 60, 0.8);
            color: white;
            border: none;
            padding: 5px 10px;
            z-index: 10000;
            cursor: pointer;
            border-radius: 4px;
            font-weight: bold;
            display: none; /* Só aparece se necessário */
        }

        @media (max-width: 768px) {
            .container { flex-direction: column; }
            .channel-list-area { max-width: 100%; max-height: 40vh; }
            .player-area { min-height: 40vh; }
        }
    </style>
</head>
<body>

<div class="header">
    <h1>Player de Transmissões</h1>
</div>

<div class="container">
    <div class="player-area">
        <div id="current-channel-name">Selecione um Canal</div>
        
        <div class="video-container">
            <iframe 
                id="main-player" 
                class="player-iframe" 
                src="" 
                allow="autoplay; fullscreen; encrypted-media; picture-in-picture" 
                sandbox="allow-scripts allow-same-origin allow-presentation allow-fullscreen allow-forms"
            ></iframe>
            
            <!-- ESCUDO DE PROTEÇÃO -->
            <div id="ad-shield"></div>
            <button id="close-shield" onclick="disableShield()">Desbloquear Cliques</button>
        </div>
    </div>

    <div class="channel-list-area">
        <h2>Lista de Canais</h2>
        <input type="text" id="channel-search" placeholder="Buscar canal...">
        <div id="channel-list-scroll">
            <div id="channel-list">
                <!-- Canais -->
                <div class="category-title">Abertos</div>
                <button class="channel-button" data-url="https://embedcanais.com/bandsp" onclick="loadChannel(this)">Band SP</button>
                <button class="channel-button" data-url="https://embedcanais.com/globosp" onclick="loadChannel(this)">Globo SP</button>
                <button class="channel-button" data-url="https://embedcanais.com/sbtsp" onclick="loadChannel(this)">SBT SP</button>
                <button class="channel-button" data-url="https://embedcanais.com/recordsp" onclick="loadChannel(this)">Record SP</button>

                <div class="category-title">Esportes</div>
                <button class="channel-button" data-url="https://embedcanais.com/sportv" onclick="loadChannel(this)">SporTV</button>
                <button class="channel-button" data-url="https://embedcanais.com/premiereclubes" onclick="loadChannel(this)">Premiere</button>
                <button class="channel-button" data-url="https://embedcanais.com/espn" onclick="loadChannel(this)">ESPN</button>
                <button class="channel-button" data-url="https://embedcanais.com/combate" onclick="loadChannel(this)">Combate</button>
                <button class="channel-button" data-url="https://embedcanais.com/dazn" onclick="loadChannel(this)">DAZN</button>

                <div class="category-title">Filmes</div>
                <button class="channel-button" data-url="https://embedcanais.com/tcpremium" onclick="loadChannel(this)">Telecine Premium</button>
                <button class="channel-button" data-url="https://embedcanais.com/hbo" onclick="loadChannel(this)">HBO</button>
                <button class="channel-button" data-url="https://embedcanais.com/max" onclick="loadChannel(this)">Max</button>
                <button class="channel-button" data-url="https://embedcanais.com/tnt" onclick="loadChannel(this)">TNT</button>

                <div class="category-title">Variedades</div>
                <button class="channel-button" data-url="https://embedcanais.com/multishow" onclick="loadChannel(this)">Multishow</button>
                <button class="channel-button" data-url="https://embedcanais.com/gnt" onclick="loadChannel(this)">GNT</button>
                <button class="channel-button" data-url="https://embedcanais.com/mtv" onclick="loadChannel(this)">MTV</button>
                <button class="channel-button" data-url="https://embedcanais.com/discoverychannel" onclick="loadChannel(this)">Discovery</button>
            </div>
        </div>
    </div>
</div>

<script>
    const player = document.getElementById('main-player');
    const channelNameDisplay = document.getElementById('current-channel-name');
    const buttons = document.querySelectorAll('.channel-button');
    const channelSearch = document.getElementById('channel-search');
    const channelList = document.getElementById('channel-list');
    const adShield = document.getElementById('ad-shield');
    let shieldTimer;

    // --- 1. Lógica de Carregamento ---
    window.onload = function() {
        if (buttons.length > 0) loadChannel(buttons[0]);
    }

    function loadChannel(button) {
        const rawUrl = button.getAttribute('data-url');
        let name = button.textContent.trim();
        const separator = rawUrl.includes('?') ? '&' : '?';
        const finalUrl = rawUrl + separator + 'autoplay=1&muted=1';
        
        player.src = finalUrl;
        channelNameDisplay.textContent = '▶️ ' + name;
        
        buttons.forEach(btn => btn.classList.remove('active'));
        button.classList.add('active');

        // Reinicia a proteção contra anúncio quando troca de canal
        startAdProtection();
    }

    // --- 2. Lógica ANTI-ANÚNCIO (O ESCUDO) ---
    function startAdProtection() {
        // Remove o bloqueio imediatamente para carregar o vídeo
        disableShield(); 

        // Limpa timer anterior se existir
        if (shieldTimer) clearTimeout(shieldTimer);

        // Configura o timer para o momento que o anúncio aparece (aprox 10s)
        // O tempo pode variar entre 8s e 12s
        shieldTimer = setTimeout(() => {
            enableShield();
        }, 12000); // 12 segundos de margem de segurança
    }

    function enableShield() {
        // Ativa o bloqueio de cliques
        adShield.classList.add('block-mode');
        console.log("Modo Proteção ATIVADO: Anúncio bloqueado.");
        
        // Simula um clique no "X" do iframe caso o navegador permita interações limitadas
        try {
            const iframeDoc = player.contentDocument || player.contentWindow.document;
            // Tenta achar o botão de fechar específico do embedcanais
            const closeBtn = iframeDoc.querySelector('.vip-modal-close');
            if(closeBtn) {
                closeBtn.click();
                console.log("Clique no 'X' executado com sucesso.");
                // Se clicou, remove o escudo
                setTimeout(disableShield, 500);
            }
        } catch(e) {
            // Se der erro de CORS, o escudo visual (pointer-events) fica ativo
            console.log("Escudo visual ativo (CORS bloqueou clique direto).");
        }
    }

    function disableShield() {
        adShield.classList.remove('block-mode');
    }

    // --- 3. Busca ---
    channelSearch.addEventListener('keyup', (e) => {
        const val = e.target.value.toLowerCase();
        const items = channelList.querySelectorAll('.channel-button, .category-title');
        items.forEach(item => {
            if (item.classList.contains('channel-button')) {
                const match = item.innerText.toLowerCase().includes(val);
                item.style.display = match ? '' : 'none';
            } else if (item.classList.contains('category-title')) {
                // Esconde categoria se não houver itens visíveis abaixo dela
                let next = item.nextElementSibling;
                let hasVisible = false;
                while(next && !next.classList.contains('category-title')) {
                    if (next.style.display !== 'none') hasVisible = true;
                    next = next.nextElementSibling;
                }
                item.style.display = (hasVisible || val === '') ? '' : 'none';
            }
        });
    });

    // --- 4. Tela Cheia ---
    function lockOrientation() {
        if (screen.orientation && screen.orientation.lock) screen.orientation.lock('landscape').catch(e => {});
    }
    function unlockOrientation() {
        if (screen.orientation && screen.orientation.unlock) screen.orientation.unlock();
    }
    document.addEventListener('fullscreenchange', () => {
        if (document.fullscreenElement) lockOrientation(); else unlockOrientation();
    });

</script>
</body>
</html>
